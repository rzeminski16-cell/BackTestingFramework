# Optimization Configuration File
# This file defines settings for walk-forward optimization
#
# NOTE: Strategy parameters are now loaded from the centralized configuration
# file at config/strategy_parameters.json. The parameters defined below are
# only used as overrides - if you need to customize ranges for optimization,
# you can specify them here and they will override the centralized values.
# For most use cases, the centralized config provides the correct defaults.

# Walk-Forward Optimization Settings
walk_forward:
  # Walk-forward mode: "rolling" or "anchored"
  # - rolling: Both training start and end dates roll forward (sliding window)
  #            Good for higher-frequency trading strategies
  # - anchored: Training always starts from same date, only end expands
  #            Good for lower-frequency trading strategies that need more data
  mode: rolling

  # Training period in days (365 = 1 year)
  # For rolling mode: Fixed window size
  # For anchored mode: Initial window size (expands over time)
  training_period_days: 365

  # Testing period in days (365 = 1 year)
  testing_period_days: 365

  # Step size for rolling/expanding forward (random between min and max days)
  step_size_min_days: 7
  step_size_max_days: 30

# Bayesian Optimization Settings
bayesian_optimization:
  # Number of iterations per optimization window
  n_iterations: 100

  # Number of random starting points before Bayesian optimization
  n_initial_points: 20

  # Random state for reproducibility (set to null for random)
  random_state: 42

  # Number of parallel jobs for optimization (set to -1 for all CPU cores)
  # Higher values = faster but more CPU usage
  # Note: Each job runs a full backtest, so memory usage increases
  # Set to -1 to use all available CPU cores for significant speedup
  n_jobs: -1

  # Fast mode: Reduces iterations for quick testing
  # Options: "full" (100 iterations), "fast" (50 iterations), "quick" (25 iterations)
  speed_mode: full

# Optimization Objective and Constraints
optimization:
  # Primary optimization metric (what to maximize)
  primary_metric: sortino_ratio

  # Constraints that must be satisfied
  constraints:
    # Profit factor must be >= this value
    min_profit_factor: 1.5

    # Max drawdown must be <= this value (percentage, e.g., 25 = 25%)
    max_drawdown_percent: 25.0

    # Minimum number of trades per year
    min_trades_per_year: 1

  # Penalty value for constraint violations
  # When constraints are violated, this value is returned instead of the actual metric
  constraint_violation_penalty: -999999.0

# Sensitivity Analysis Settings
sensitivity_analysis:
  # For floating point parameters, test +/- this percentage
  float_variation_percent: 10.0

  # For integer parameters, test +/- this amount
  int_variation_amount: 1

  # Whether to test all parameter combinations or individual parameters
  # Options: "individual" (test one param at a time) or "combinations" (test all combos)
  test_mode: combinations

  # Maximum number of sensitivity tests to run
  # Set to null for unlimited (will test all combinations)
  max_sensitivity_tests: 1000

# Report Settings
report:
  # Output directory for optimization reports
  output_dir: logs/optimization_reports

  # Excel file format settings
  excel:
    # Include charts in Excel report
    include_charts: true

    # Chart types to include
    chart_types:
      - equity_curve
      - parameter_sensitivity
      - walk_forward_performance
      - in_sample_vs_out_sample

    # Number formatting
    decimal_places: 4

# Strategy Parameter Ranges (OVERRIDES ONLY)
# Parameters are loaded from config/strategy_parameters.json by default.
# Use this section ONLY to override specific parameter ranges for optimization.
# Any values specified here will override the centralized config.
#
# Format:
#   StrategyClassName:
#     parameter_name:
#       min: minimum_value
#       max: maximum_value
#       type: "int" or "float"
#       step: step_size (optional, for grid search fallback)
#       values: [list of specific values] (optional, instead of min/max/step)

strategy_parameters:
  AlphaTrendStrategy:
    volume_short_ma:
      min: 2
      max: 10
      type: int
      step: 1

    volume_long_ma:
      min: 20
      max: 50
      type: int
      step: 5

    volume_alignment_window:
      min: 5
      max: 20
      type: int
      step: 1

    stop_loss_percent:
      min: 0.0
      max: 5.0
      type: float
      step: 0.5

    atr_stop_loss_multiple:
      min: 1.5
      max: 4.0
      type: float
      step: 0.25

    grace_period_bars:
      min: 5
      max: 30
      type: int
      step: 5

    momentum_gain_pct:
      min: 1.0
      max: 5.0
      type: float
      step: 0.5

    momentum_lookback:
      min: 3
      max: 14
      type: int
      step: 1

    risk_percent:
      min: 0.5
      max: 10.0
      type: float
      step: 0.5

    atr_multiplier:
      min: 0.5
      max: 3.0
      type: float
      step: 0.1

    smoothing_length:
      min: 1
      max: 10
      type: int
      step: 1

    percentile_period:
      min: 20
      max: 200
      type: int
      step: 10

  RandomBaseStrategy:
    entry_probability:
      min: 0.01
      max: 0.20
      type: float
      step: 0.01
      description: "Probability of entry each bar (0.10 = 10%)"

    exit_probability:
      min: 0.01
      max: 0.20
      type: float
      step: 0.01
      description: "Probability of exit each bar (0.10 = 10%)"

    position_size_pct:
      min: 1.0
      max: 20.0
      type: float
      step: 1.0
      description: "Position size as percentage of capital"

    stop_loss_atr_multiple:
      min: 1.0
      max: 4.0
      type: float
      step: 0.5
      description: "ATR multiplier for stop loss calculation"


# Vulnerability Score Parameters (for portfolio capital contention optimization)
# These parameters can be optimized when using the Vulnerability Score capital contention mode
vulnerability_score_parameters:
  immunity_days:
    min: 3
    max: 14
    type: int
    step: 1
    description: "Days a new trade is protected from being swapped"

  min_profit_threshold:
    min: 0.005
    max: 0.05
    type: float
    step: 0.005
    description: "Profit % below which trade is considered stagnant (0.02 = 2%)"

  decay_rate_fast:
    min: 2.0
    max: 10.0
    type: float
    step: 1.0
    description: "Points lost per day for stagnant trades"

  decay_rate_slow:
    min: 0.5
    max: 3.0
    type: float
    step: 0.5
    description: "Points lost per day for performing trades"

  swap_threshold:
    min: 30.0
    max: 70.0
    type: float
    step: 5.0
    description: "Score below which position can be swapped (0-100)"


# Performance Thresholds for Reporting
reporting:
  # Highlight parameters as "robust" if performance variance is less than this %
  robust_threshold_percent: 15.0

  # Flag parameters as "unstable" if performance variance is greater than this %
  unstable_threshold_percent: 50.0

  # Top N parameter sets to include in detailed report
  top_n_parameter_sets: 10

  # Include individual window results in report
  include_window_details: true

  # Include all tested parameter combinations
  include_all_results: false
